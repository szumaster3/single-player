// 506
[proc,script506](int $int0)(boolean)
def_int $chattype1 = chat_gethistorytype($int0);
if (%varclient_41 = 5 & string_length(%varclientstring_0) > 0) {
    switch_int ($chattype1) {
        case ^chattype_publicchat, ^chattype_modchat, ^chattype_privatechat, ^chattype_privatechatout, ^chattype_modprivatechat, ^chattype_friendschat, ^chattype_18, ^chattype_19, ^chattype_20 :
            if (compare(removetags(chat_gethistoryname($int0)), %varclientstring_0) = 0 | compare(removetags(chat_gethistoryname($int0)), chat_playername) = 0) {
                if (chat_getfilter_trade = ^chatfilter_on) {
                    return(true);
                }
                if (chat_getfilter_trade = ^chatfilter_friends & friend_test(chat_gethistoryname($int0)) = true) {
                    return(true);
                }
                if ($chattype1 = ^chattype_modchat | $chattype1 = ^chattype_modprivatechat) {
                    return(true);
                }
            }
    }
}
return(false);
